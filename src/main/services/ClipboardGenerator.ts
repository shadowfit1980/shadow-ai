/**
 * ðŸ“‹ ClipboardGenerator
 * 
 * Clipboard utilities:
 * - Copy, paste, history, sync
 */

import { EventEmitter } from 'events';

export class ClipboardGenerator extends EventEmitter {
    private static instance: ClipboardGenerator;
    private constructor() { super(); }
    static getInstance(): ClipboardGenerator {
        if (!ClipboardGenerator.instance) {
            ClipboardGenerator.instance = new ClipboardGenerator();
        }
        return ClipboardGenerator.instance;
    }

    generate(): string {
        return `// Clipboard Generator - Copy, paste, history, sync
// Generated by Shadow AI

// React Hook for Clipboard
export function useClipboard() {
    const [copied, setCopied] = useState(false);
    
    const copy = async (text: string) => {
        try {
            await navigator.clipboard.writeText(text);
            setCopied(true);
            setTimeout(() => setCopied(false), 2000);
            return true;
        } catch (err) {
            console.error('Failed to copy:', err);
            return false;
        }
    };
    
    const paste = async (): Promise<string | null> => {
        try {
            return await navigator.clipboard.readText();
        } catch (err) {
            console.error('Failed to paste:', err);
            return null;
        }
    };
    
    return { copy, paste, copied };
}

// Clipboard History (Electron)
class ClipboardHistory {
    private history: string[] = [];
    private maxSize = 100;
    
    add(text: string) {
        this.history = [text, ...this.history.filter(t => t !== text)].slice(0, this.maxSize);
    }
    
    getHistory() {
        return this.history;
    }
    
    clear() {
        this.history = [];
    }
}

// Copy Button Component
export function CopyButton({ text, children }: { text: string; children?: React.ReactNode }) {
    const { copy, copied } = useClipboard();
    
    return (
        <button onClick={() => copy(text)} className="copy-button">
            {copied ? (
                <><CheckIcon /> Copied!</>
            ) : (
                <>{children || <><CopyIcon /> Copy</>}</>
            )}
        </button>
    );
}
`;
    }
}

export const clipboardGenerator = ClipboardGenerator.getInstance();
