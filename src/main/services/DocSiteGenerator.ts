/**
 * üìö Documentation Site Generator
 * 
 * Generate doc sites:
 * - Docusaurus, VitePress
 */

import { EventEmitter } from 'events';

export type DocFramework = 'docusaurus' | 'vitepress';

export class DocSiteGenerator extends EventEmitter {
    private static instance: DocSiteGenerator;

    private constructor() { super(); }

    static getInstance(): DocSiteGenerator {
        if (!DocSiteGenerator.instance) {
            DocSiteGenerator.instance = new DocSiteGenerator();
        }
        return DocSiteGenerator.instance;
    }

    getFrameworks(): DocFramework[] {
        return ['docusaurus', 'vitepress'];
    }

    generate(framework: DocFramework): string {
        switch (framework) {
            case 'docusaurus': return this.generateDocusaurus();
            case 'vitepress': return this.generateVitePress();
            default: return '';
        }
    }

    private generateDocusaurus(): string {
        return `// Docusaurus Configuration
// Generated by Shadow AI

// docusaurus.config.js
import { themes } from 'prism-react-renderer';

const config = {
    title: 'My Documentation',
    tagline: 'Developer Documentation',
    favicon: 'img/favicon.ico',

    url: 'https://docs.example.com',
    baseUrl: '/',

    organizationName: 'your-org',
    projectName: 'your-project',

    onBrokenLinks: 'throw',
    onBrokenMarkdownLinks: 'warn',

    i18n: {
        defaultLocale: 'en',
        locales: ['en', 'es', 'fr']
    },

    presets: [
        [
            'classic',
            {
                docs: {
                    sidebarPath: './sidebars.js',
                    editUrl: 'https://github.com/your-org/your-repo/tree/main/',
                    showLastUpdateAuthor: true,
                    showLastUpdateTime: true
                },
                blog: {
                    showReadingTime: true,
                    editUrl: 'https://github.com/your-org/your-repo/tree/main/'
                },
                theme: {
                    customCss: './src/css/custom.css'
                }
            }
        ]
    ],

    themeConfig: {
        image: 'img/social-card.jpg',
        
        navbar: {
            title: 'My Docs',
            logo: { alt: 'Logo', src: 'img/logo.svg' },
            items: [
                { type: 'docSidebar', sidebarId: 'tutorialSidebar', label: 'Docs' },
                { to: '/blog', label: 'Blog' },
                { to: '/api', label: 'API' },
                { type: 'docsVersionDropdown' },
                { type: 'localeDropdown' },
                { href: 'https://github.com/your-org/your-repo', label: 'GitHub', position: 'right' }
            ]
        },

        footer: {
            style: 'dark',
            links: [
                {
                    title: 'Docs',
                    items: [
                        { label: 'Getting Started', to: '/docs/intro' },
                        { label: 'API Reference', to: '/docs/api' }
                    ]
                },
                {
                    title: 'Community',
                    items: [
                        { label: 'Discord', href: 'https://discord.gg/your-server' },
                        { label: 'Twitter', href: 'https://twitter.com/your-handle' }
                    ]
                }
            ],
            copyright: \`Copyright ¬© \${new Date().getFullYear()} Your Company\`
        },

        prism: {
            theme: themes.github,
            darkTheme: themes.dracula,
            additionalLanguages: ['bash', 'typescript', 'json']
        },

        algolia: {
            appId: 'YOUR_APP_ID',
            apiKey: 'YOUR_SEARCH_API_KEY',
            indexName: 'your_index'
        }
    },

    plugins: [
        ['@docusaurus/plugin-ideal-image', { quality: 70, max: 1030, min: 640 }],
        ['docusaurus-plugin-openapi-docs', {
            id: 'openapi',
            docsPluginId: 'classic',
            config: {
                petstore: { specPath: 'openapi/petstore.yaml', outputDir: 'docs/api' }
            }
        }]
    ]
};

export default config;

// sidebars.js
const sidebars = {
    tutorialSidebar: [
        'intro',
        {
            type: 'category',
            label: 'Getting Started',
            items: ['installation', 'quick-start', 'configuration']
        },
        {
            type: 'category',
            label: 'Guides',
            items: ['guides/authentication', 'guides/deployment', 'guides/testing']
        },
        {
            type: 'category',
            label: 'API Reference',
            link: { type: 'generated-index', title: 'API Reference' },
            items: [{ type: 'autogenerated', dirName: 'api' }]
        }
    ]
};

module.exports = sidebars;
`;
    }

    private generateVitePress(): string {
        return `// VitePress Configuration
// Generated by Shadow AI

// .vitepress/config.ts
import { defineConfig } from 'vitepress';

export default defineConfig({
    title: 'My Documentation',
    description: 'Developer Documentation',

    head: [
        ['link', { rel: 'icon', href: '/favicon.ico' }],
        ['meta', { property: 'og:type', content: 'website' }]
    ],

    themeConfig: {
        logo: '/logo.svg',

        nav: [
            { text: 'Guide', link: '/guide/' },
            { text: 'API', link: '/api/' },
            { text: 'Examples', link: '/examples/' },
            {
                text: 'v1.0.0',
                items: [
                    { text: 'Changelog', link: '/changelog' },
                    { text: 'Contributing', link: '/contributing' }
                ]
            }
        ],

        sidebar: {
            '/guide/': [
                {
                    text: 'Introduction',
                    items: [
                        { text: 'Getting Started', link: '/guide/' },
                        { text: 'Installation', link: '/guide/installation' },
                        { text: 'Quick Start', link: '/guide/quick-start' }
                    ]
                },
                {
                    text: 'Core Concepts',
                    items: [
                        { text: 'Configuration', link: '/guide/configuration' },
                        { text: 'Authentication', link: '/guide/authentication' },
                        { text: 'Database', link: '/guide/database' }
                    ]
                }
            ],
            '/api/': [
                {
                    text: 'API Reference',
                    items: [
                        { text: 'Overview', link: '/api/' },
                        { text: 'REST API', link: '/api/rest' },
                        { text: 'SDK', link: '/api/sdk' }
                    ]
                }
            ]
        },

        socialLinks: [
            { icon: 'github', link: 'https://github.com/your-org/your-repo' },
            { icon: 'discord', link: 'https://discord.gg/your-server' },
            { icon: 'twitter', link: 'https://twitter.com/your-handle' }
        ],

        footer: {
            message: 'Released under the MIT License.',
            copyright: 'Copyright ¬© 2024 Your Company'
        },

        search: {
            provider: 'algolia',
            options: {
                appId: 'YOUR_APP_ID',
                apiKey: 'YOUR_API_KEY',
                indexName: 'your_index'
            }
        },

        editLink: {
            pattern: 'https://github.com/your-org/your-repo/edit/main/docs/:path',
            text: 'Edit this page on GitHub'
        },

        lastUpdated: {
            text: 'Updated at',
            formatOptions: { dateStyle: 'full', timeStyle: 'short' }
        }
    },

    markdown: {
        lineNumbers: true,
        theme: { light: 'github-light', dark: 'github-dark' }
    },

    vite: {
        plugins: []
    }
});

// index.md (homepage)
---
layout: home

hero:
  name: "My Project"
  text: "Build amazing things"
  tagline: The modern development toolkit
  image:
    src: /hero.png
    alt: Hero image
  actions:
    - theme: brand
      text: Get Started
      link: /guide/
    - theme: alt
      text: View on GitHub
      link: https://github.com/your-org/your-repo

features:
  - icon: üöÄ
    title: Fast
    details: Lightning fast performance with modern architecture
  - icon: üîß
    title: Flexible
    details: Highly customizable to fit your needs
  - icon: üõ°Ô∏è
    title: Secure
    details: Built with security best practices
---
`;
    }
}

export const docSiteGenerator = DocSiteGenerator.getInstance();
