/**
 * ðŸ“± ResponsiveGenerator
 * 
 * Responsive design:
 * - Breakpoints, hooks, utilities
 */

import { EventEmitter } from 'events';

export class ResponsiveGenerator extends EventEmitter {
    private static instance: ResponsiveGenerator;
    private constructor() { super(); }
    static getInstance(): ResponsiveGenerator {
        if (!ResponsiveGenerator.instance) {
            ResponsiveGenerator.instance = new ResponsiveGenerator();
        }
        return ResponsiveGenerator.instance;
    }

    generate(): string {
        return `// Responsive Generator - Breakpoints, hooks, utilities
// Generated by Shadow AI

// Breakpoints
const breakpoints = {
    xs: 0,
    sm: 640,
    md: 768,
    lg: 1024,
    xl: 1280,
    '2xl': 1536
};

// useMediaQuery Hook
export function useMediaQuery(query: string): boolean {
    const [matches, setMatches] = useState(() => 
        typeof window !== 'undefined' ? window.matchMedia(query).matches : false
    );
    
    useEffect(() => {
        const mediaQuery = window.matchMedia(query);
        const handler = (e: MediaQueryListEvent) => setMatches(e.matches);
        
        mediaQuery.addEventListener('change', handler);
        return () => mediaQuery.removeEventListener('change', handler);
    }, [query]);
    
    return matches;
}

// useBreakpoint Hook
export function useBreakpoint() {
    const [breakpoint, setBreakpoint] = useState<keyof typeof breakpoints>('xs');
    
    useEffect(() => {
        const getBreakpoint = (): keyof typeof breakpoints => {
            const width = window.innerWidth;
            if (width >= breakpoints['2xl']) return '2xl';
            if (width >= breakpoints.xl) return 'xl';
            if (width >= breakpoints.lg) return 'lg';
            if (width >= breakpoints.md) return 'md';
            if (width >= breakpoints.sm) return 'sm';
            return 'xs';
        };
        
        const handler = () => setBreakpoint(getBreakpoint());
        handler();
        
        window.addEventListener('resize', handler);
        return () => window.removeEventListener('resize', handler);
    }, []);
    
    return {
        breakpoint,
        isXs: breakpoint === 'xs',
        isSm: breakpoint === 'sm',
        isMd: breakpoint === 'md',
        isLg: breakpoint === 'lg',
        isXl: breakpoint === 'xl',
        is2Xl: breakpoint === '2xl',
        isMobile: ['xs', 'sm'].includes(breakpoint),
        isTablet: breakpoint === 'md',
        isDesktop: ['lg', 'xl', '2xl'].includes(breakpoint)
    };
}

// useWindowSize Hook
export function useWindowSize() {
    const [size, setSize] = useState({ width: 0, height: 0 });
    
    useEffect(() => {
        const handler = () => setSize({ width: window.innerWidth, height: window.innerHeight });
        handler();
        
        window.addEventListener('resize', handler);
        return () => window.removeEventListener('resize', handler);
    }, []);
    
    return size;
}

// Responsive Container Component
export function Container({ children, maxWidth = 'xl' }: { children: React.ReactNode; maxWidth?: keyof typeof breakpoints }) {
    return (
        <div style={{ maxWidth: breakpoints[maxWidth], marginInline: 'auto', paddingInline: '1rem' }}>
            {children}
        </div>
    );
}

// Hide/Show Components
export function ShowAbove({ breakpoint, children }: { breakpoint: keyof typeof breakpoints; children: React.ReactNode }) {
    const above = useMediaQuery(\`(min-width: \${breakpoints[breakpoint]}px)\`);
    return above ? <>{children}</> : null;
}

export function HideAbove({ breakpoint, children }: { breakpoint: keyof typeof breakpoints; children: React.ReactNode }) {
    const above = useMediaQuery(\`(min-width: \${breakpoints[breakpoint]}px)\`);
    return above ? null : <>{children}</>;
}

// CSS Utilities
const responsiveCSS = \`
/* Container */
.container { width: 100%; margin-inline: auto; padding-inline: 1rem; }
@media (min-width: 640px) { .container { max-width: 640px; } }
@media (min-width: 768px) { .container { max-width: 768px; } }
@media (min-width: 1024px) { .container { max-width: 1024px; } }
@media (min-width: 1280px) { .container { max-width: 1280px; } }

/* Show/Hide */
.hidden { display: none; }
@media (min-width: 640px) { .sm\\:block { display: block; } .sm\\:hidden { display: none; } }
@media (min-width: 768px) { .md\\:block { display: block; } .md\\:hidden { display: none; } }
@media (min-width: 1024px) { .lg\\:block { display: block; } .lg\\:hidden { display: none; } }
\`;

export { breakpoints, responsiveCSS, Container, ShowAbove, HideAbove };
`;
    }
}

export const responsiveGenerator = ResponsiveGenerator.getInstance();
